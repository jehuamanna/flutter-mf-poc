<!DOCTYPE html>
<html>
  <head>
    <script src="https://unpkg.com/single-spa"></script>
    
    <script src="flutter.js" defer></script>
  </head>

  <body>
    <script>
     

    const serviceWorkerVersion = "2236727339";
      
     
    window.addEventListener('load', function() {
      function loader( entrypointUrl) {
      // Download main.dart.js
      console.log(entrypointUrl)
      _flutter.loader.loadEntrypoint({
        entrypointUrl,
        serviceWorker: {
          serviceWorkerUrl: 'flutter_service_worker.js?v=',
          serviceWorkerVersion: serviceWorkerVersion,
        },
        onEntrypointLoaded: async function(engineInitializer) {
          // Initialize the Flutter engine
          try {
          let appRunner = await engineInitializer.initializeEngine();
          // Run the app

            await appRunner.runApp();
          } catch (e) {
            console.log(e)
          }
        }
      });
   }



     
  const app = {
  // Optional
  async bootstrap(props) {
    console.log("App is initializing!", props);
  },
  // Required
  async mount(props) {
    console.log("App is mounting", props);
    loader('main.dart.js',)
  },
  // Required
  async unmount(props) {
    console.log("App is unmounting", props);
    const x = document.querySelector("flt-glass-pane")
    x.remove()
  },
};
const app1 = {
  // Optional
  async bootstrap(props) {
    console.log("App2 is initializing!", props);
  },
  // Required
  async mount(props) {
    console.log("App2 is mounting", props);
    loader('g1s1/main.dart.js')
  },
  // Required
  async unmount(props) {
    console.log("App2 is unmounting", props);
    const x = document.querySelector("flt-glass-pane")
    x.remove()
  },
};

const app2 = {
  // Optional
  async bootstrap(props) {
    console.log("App3 is initializing!", props);
  },
  // Required
  async mount(props) {
    console.log("App3 is mounting", props);
    loader('g2s1/main.dart.js')
  },
  // Required
  async unmount(props) {
    console.log("App3 is unmounting", props);
    const x = document.querySelector("flt-glass-pane")
    x.remove()
  },
};

const app3 = {
  // Optional
  async bootstrap(props) {
    console.log("App4 is initializing!", props);
  },
  // Required
  async mount(props) {
    console.log("App4 is mounting", props);
    loader('g3s1/main.dart.js')
  },
  // Required
  async unmount(props) {
    console.log("App4 is unmounting", props);
    const x = document.querySelector("flt-glass-pane")
    x.remove()
  },
};
  singleSpa.registerApplication({name: 'Flutter APP', app, activeWhen: "/",  customProps(location) {return true}});
      singleSpa.registerApplication({name: 'Group one Service one', app:app1, activeWhen: "/grouponeservieone",  customProps(location) {return true}});
      singleSpa.registerApplication({name: 'Group Two service One', app:app2, activeWhen: "/grouptwoserviceone",  customProps(location) {return true}});
      singleSpa.registerApplication({name: 'Group three SErvice one', app:app3, activeWhen: "/groupthreeserviceone",  customProps(location) {return true}});
      singleSpa.start();
      
  })

     
    </script>
  </body>
</html>


